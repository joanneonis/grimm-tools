{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///./helpers/loadJSON.js","webpack:///./tools/highlight/main.js"],"names":["loadJSON","fileName","callback","type","xobj","XMLHttpRequest","overrideMimeType","open","onreadystatechange","e","readyState","status","responseText","console","log","timeStampToTime","timeStamp","send","pad","num","size","s","length","unix_timestamp","date","Date","hours","getHours","minutes","getMinutes","seconds","getSeconds","substr","animalData","totalToSearch","progress","handleFileSelect","evt","files","target","f","reader","FileReader","onload","JSON","parse","result","listAnimals","readAsText","document","getElementById","addEventListener","storyIndex","storyCount","storyMin","stories","storiesCombined","animalCounts","fullTextContainer","querySelector","srcElement","value","loadStories","response","i","push","title","init","innerHTML","style","display","highLight","textContainer","randomColor","Math","random","toString","item","text","featuredWords","querySelectorAll","words","Array","prototype","slice","call","map","node","textContent","regex","RegExp","replace","countOccurances","match","count","data","container","forEach","storyContainer","animal","d","n","getTime","updateProgress","listItem","createElement","classList","add","appendChild","total","progressPerc","toFixed"],"mappings":"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","file":"highlight.bundle.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = \"./tools/highlight/main.js\");\n","export function loadJSON(fileName, callback, type) {   \n\tvar xobj = new XMLHttpRequest();\n      if (type === 'json') { xobj.overrideMimeType(\"application/json\"); }\n\t\t\txobj.open('GET', fileName, true);\n\t\t\txobj.onreadystatechange = function (e) {\n\t\t\t\tif (xobj.readyState == 4 && xobj.status == \"200\") {\n\t\t\t\t\t// Required use of an anonymous callback as .open will NOT return a value but simply returns undefined in asynchronous mode\n\t\t\t\t\tcallback(xobj.responseText);\n\t\t\t\t\tconsole.log(`loaded ${fileName} - ${timeStampToTime(e.timeStamp)}`);\n\t\t\t\t}\n\t};\n\txobj.send(null);\n}\n\nexport function pad(num, size) {\n  var s = num+\"\";\n  while (s.length < size) s = \"0\" + s;\n  return s;\n}\n\nfunction timeStampToTime(unix_timestamp) {\n\t// Create a new JavaScript Date object based on the timestamp\n\t// multiplied by 1000 so that the argument is in milliseconds, not seconds.\n\tvar date = new Date(unix_timestamp*1000);\n\t// Hours part from the timestamp\n\tvar hours = date.getHours();\n\t// Minutes part from the timestamp\n\tvar minutes = \"0\" + date.getMinutes();\n\t// Seconds part from the timestamp\n\tvar seconds = \"0\" + date.getSeconds();\n\n\n\treturn hours + ':' + minutes.substr(-2) + ':' + seconds.substr(-2);\n}","import { loadJSON, pad } from '../../helpers/loadJSON';\n\nlet animalData;\n\nlet totalToSearch;\nlet progress = 0;\n\nfunction handleFileSelect(evt) {\n\tvar files = evt.target.files; // FileList object\n\n\t// use the 1st file from the list\n\tlet f = files[0];\n\n\tvar reader = new FileReader();\n\n\t// Closure to capture the file information.\n\treader.onload = (() => {\n\t\t\treturn function(e) {\n\t\t\t\tanimalData = JSON.parse(e.target.result);\n\t\t\t\tconsole.log('uploaded', animalData);\n\t\t\t\tlistAnimals(animalData);\n\n\t\t\t\ttotalToSearch = animalData.length;\n\t\t\t};\n\t\t})(f);\n\n\t\t// Read in the image file as a data URL.\n\t\treader.readAsText(f);\n}\n\ndocument.getElementById('upload').addEventListener('change', handleFileSelect, false);\n\n/*\n\tTHE REST\n*/\n\nlet storyIndex;\nlet storyCount = 209; // 209\nlet storyMin = 0;\nlet stories = [];\nlet storiesCombined = '';\nlet animalCounts = [];\n\nconst fullTextContainer = document.querySelector('.stories-combined');\n// let storyCount = document.getElementById('upload');\n\ndocument.getElementById('storyMax').addEventListener('change', function(e) {\n\tstoryCount = e.srcElement.value;\n}, false);\n\ndocument.getElementById('storyMin').addEventListener('change', function(e) {\n\tstoryMin = e.srcElement.value;\n}, false);\n\ndocument.getElementById('load').addEventListener('click', function() {\n\tloadStories();\n});\n\nfunction loadStories() {\n\tloadJSON('../../assets/stories/index.json', (response) => {\n\t\tstoryIndex = JSON.parse(response);\n\t}, 'json');\n\n  for (let i = storyMin; i < storyCount; i++) {\n    loadJSON(`../../assets/stories/${pad(i + 1, 3)}.txt`, (response) => {\n      // store seperate stories\n      stories.push(response);\n  \n      if (i === 0) {\n        storiesCombined = `<span class=\"story\"><span class=\"title\">${storyIndex[i].title}</span>${response}</span>`\n      } else {\n        storiesCombined = `\n          ${storiesCombined}\n          <span class=\"story\">\n            <span class=\"title\">${storyIndex[i].title}</span>\n            ${response}\n          </span>\n        `;\n      }\n  \n      if (i === storyCount - 1) init();\n    });\n  }  \n}\n\n\nfunction init() {\n\tfullTextContainer.innerHTML = storiesCombined;\n\tdocument.querySelector('.upload').style.display = 'block';\n}\n\n//?-----------\n\nfunction highLight(target, textContainer, i) {\n\tlet randomColor = '#'+(Math.random()*0xFFFFFF<<0).toString(16);\n  var item = textContainer;\n\tvar text = item.innerHTML; // textcontent\n\t// var textContent = item.textContent;\n  var featuredWords = item.querySelectorAll('.highlight');\n  \n  var words = Array.prototype.slice.call(featuredWords, 0).map(function(node) {\n    return node.textContent;  \n  })\n  \n  // first highlight\n  var regex = new RegExp('\\\\b(' + target + ')\\\\b', 'ig', 'a');\n  text = text.replace(regex, `<span class=\"highlight\" style=\"background-color: ${randomColor}\">$1</span>`);\n  // text = text.replace(/target/g, \"a\");\n\n  var countOccurances = ((text || '').match(regex) || []).length;\n\n  animalCounts[i].count = countOccurances;\n  \n  item.innerHTML = text;\n}\n\n//?------------------\n\nfunction listAnimals(data) {\n  let container = document.querySelector('#animals');\n\n  data.forEach((text, i) => {\n    let storyContainer = document.querySelector('.stories-combined'); \n    \n    animalCounts.push({ animal: text });\n\t\thighLight(text, storyContainer, i);\n\n\t\tvar d = new Date();\n\t\tvar n = d.getTime();\n\n\t\tupdateProgress(i, data.length);\n  });\n  \n  // animalCounts.sort((a, b) => (a.count > b.count) ? -1 : 1);\n  animalCounts.forEach((item, i) => {\n    var listItem = document.createElement(\"tr\");\n    listItem.classList.add(`animal-${i}`);\n    \n    listItem.innerHTML = `\n      <td>${item.animal}</td>\n      <td>${item.count}</td>\n    `;\n\n\t\tcontainer.appendChild(listItem);\n\t});\n\t\n\t// done hack\n\tupdateProgress(1, 1);\n} \n\nfunction updateProgress(progress, total) {\n\t// let bar = document.querySelector('.progress_bar');\n\t\n\tlet progressPerc = 100 - (((progress - total) / total ) * -100);\n\t// bar.style.width = `${progressPerc}%`;\n\tconsole.log(`loaded ${progressPerc.toFixed(1)}% of the search`);\n}"],"sourceRoot":""}